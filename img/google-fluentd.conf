
<source>
  @type tail

  path /home/wwwroot/bi.product.com/Logs/Events/event_%Y%m%d%H.log
  read_from_head true
  path_timezone "+00"
  pos_file /var/google-fluentd/pos/tail_log.pos
  refresh_interval 30s
  tag triwin_agent
  enable_stat_watcher false
  <parse>
    @type json
  </parse>
</source>

<source>
  @type tail

  path /home/wwwroot/bi.product.com/Logs/Events/event_%Y%m%d%H.log
  read_from_head true
  path_timezone "+00"
  pos_file /var/google-fluentd/pos/abtest_tail_log.pos
  refresh_interval 30s
  tag abtest
  enable_stat_watcher false
  <parse>
    @type json
  </parse>
</source>


<system>
  root_dir /var/google-fluentd/error_chunk/
</system>

<filter *>
  @type record_modifier
  <record>
    time ${record['time']=time.to_i}
  </record>
</filter>

<match triwin_agent>
  @type gcloud_pubsub
  project triwin-gcp-313003
  key /home/gcp/triwin-gcp-313003-65843742d37e.json
  topic projects/triwin-gcp-313003/topics/user_event_data_realtime
  autocreate_topic false
  max_messages 1000
  max_total_size 8000000
  buffer_type file
  buffer_path /var/google-fluentd/pubsub_buffer/
  flush_interval 1s
  <format>
    @type json
    add_newline false
  </format>
</match>

<match abtest>
  @type gcloud_pubsub
  project triwin-gcp-313003
  key /home/gcp/triwin-gcp-313003-65843742d37e.json
  topic projects/triwin-gcp-313003/topics/user_event_abtest
  autocreate_topic false
  max_messages 1000
  max_total_size 8000000
  buffer_type file
  buffer_path /var/google-fluentd/abtest_buffer/
  flush_interval 1s
  <format>
    @type json
    add_newline false
  </format>
</match>